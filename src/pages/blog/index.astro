---
import { getCollection } from "astro:content";
import Background from "../../components/Background.astro";
import BaseHead from "../../components/BaseHead.astro";
import Footer from "../../components/Footer.astro";
import Header from "../../components/Header.astro";
import { JustifiedContent } from "../../components/JustifiedContent";
import { SITE_DESCRIPTION, SITE_TITLE } from "../../consts";

const posts = (await getCollection("blog")).sort(
    (a, b) => a.data.pubDate.valueOf() - b.data.pubDate.valueOf()
);
---

<!DOCTYPE html>
<html class="dark h-full antialiased" lang="en">
    <head>
        <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
        <style>
            ul {
                list-style-type: none;
                padding: unset;
            }
            ul li {
                display: flex;
            }
            ul li time {
                flex: 0 0 130px;
                font-style: italic;
                color: #595959;
            }
            ul li a:visited {
                color: #8e32dc;
            }
        </style>
    </head>
    <body class="flex h-full flex-col bg-zinc-50 dark:bg-black">
        <Background />
        <div class="relative">
            <Header />
            <main>
                <JustifiedContent class="">
                    <section>
                        <ul>
                            {
                                posts.map((post) => (
                                    <li>
                                        <time datetime={post.data.pubDate.toISOString()}>
                                            {post.data.pubDate.toLocaleDateString("en-us", {
                                                year: "numeric",
                                                month: "short",
                                                day: "numeric",
                                            })}
                                        </time>
                                        <a href={`/blog/${post.slug}/`}>{post.data.title}</a>
                                    </li>
                                ))
                            }
                        </ul>
                    </section>
                </JustifiedContent>
            </main>
        </div>
        <Footer />
    </body>
</html>
